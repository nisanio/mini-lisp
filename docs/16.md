# Chapter 16 — Coding Standards and Conventions

## 16.1 Overview

Consistency in code style and conventions is critical to maintaining Mini Lisp’s readability and extensibility. This chapter describes the conventions followed in the C source and the Lisp standard library.

## 16.2 C Source Code Conventions

### 16.2.1 Naming

* **Types and structs**: `CamelCase` (e.g., `SyntaxTransformer`).
* **Functions**: `snake_case` (e.g., `make_env`, `macroexpand1_hygienic`).
* **Constants/enums**: Uppercase with underscores (e.g., `VAL_PAIR`, `MAX_EXPANSION_DEPTH`).
* **Files**: lowercase, grouped by subsystem (`eval.c`, `macros.c`).

### 16.2.2 Formatting

* Indentation: 4 spaces, no tabs.
* Braces: K\&R style.

  ```c
  if (cond) {
      ...
  } else {
      ...
  }
  ```
* Lines limited to \~80–100 characters.

### 16.2.3 Error Messages

* Prefix with subsystem or function name when relevant.
* Lowercase, human-readable messages (e.g., `error: car: argument is not a pair`).

### 16.2.4 Memory

* Always allocate via helper functions (`make_*`).
* Use `xstrdup` for string duplication.
* Free via module-specific cleanup functions when available.

## 16.3 Lisp Code Conventions (`stdlib.lisp` and examples)

### 16.3.1 Naming

* Functions: lowercase with hyphens (e.g., `map`, `vector-set!`).
* Macros: lowercase with hyphens (e.g., `when`, `unless`).
* Predicates: suffix with `?` (e.g., `null?`, `pair?`).
* Mutators: suffix with `!` (e.g., `set!`, `vector-set!`).

### 16.3.2 Formatting

* One form per line for clarity in nested expressions.
* Align arguments in macros like `syntax-rules`.

### 16.3.3 Comments

* `;;` for single-line comments.
* Top-level documentation at the beginning of library files.

## 16.4 Documentation

* Each C file begins with a header comment summarizing purpose.
* Each public function documented in header files with parameter and return descriptions.
* Each Lisp library file documents provided utilities and intended usage.

## 16.5 Testing Conventions

* Tests placed in `tests/` with incremental numbering.
* Each test isolates one subsystem.
* Error cases explicitly documented in `05_errors.lisp`.

---

Next chapter: **Roadmap and Future Work** — planned improvements and technical debt.
