# Chapter 1 — Vision Overview

## 1.1 Purpose

Mini Lisp is a lightweight Lisp interpreter written in C. Its primary goal is to provide a compact, readable, and extensible implementation of a Lisp system that supports both basic evaluation and hygienic macros via `define-syntax` and `syntax-rules`.

## 1.2 Design Philosophy

* **Simplicity**: Keep the codebase small and accessible for learning and extension.
* **Portability**: Adhere to strict C standards, replacing non-portable calls (e.g., `strdup`) with safe wrappers.
* **Clarity**: Favor direct, explicit implementations of core Lisp mechanisms.
* **Extensibility**: Provide hooks for adding new built-ins, types, and macros.

## 1.3 Runtime Components

Mini Lisp’s runtime consists of:

* **Value system**: Tagged union representing Lisp types (integers, symbols, strings, pairs, closures, builtins, vectors, hashes, booleans, nil).
* **Environment model**: Lexically scoped frames for symbol binding.
* **Evaluator**: Recursive descent evaluator with integrated macro expansion.
* **Macro system**: Hygienic macros with `syntax-rules` pattern/template expansion.
* **Built-in library**: Arithmetic, list manipulation, string/vector/hash operations, file I/O, printing, debugging.
* **Reader/Parser**: Converts textual Lisp code into runtime values.
* **REPL**: Interactive loop for reading, evaluating, and printing results.

## 1.4 High-Level Flow

The execution cycle follows the traditional Lisp pipeline:

```
read → expand → eval → print
```

1. **Read**: Parse Lisp source into internal `Value*` structures.
2. **Expand**: Perform macro expansion (`macroexpand-1`, repeated up to 128 steps).
3. **Eval**: Dispatch on special forms or apply closures/builtins.
4. **Print**: Render results to output.

## 1.5 Current Status

* Core evaluator stable, passes functional tests.
* Macro system operational with hygienic `syntax-rules` expansion.
* Example macros (`and`, `unless`, `when`, `or`) validated.
* Error handling returns `nil` and prints messages, with dedicated test suite.

## 1.6 Roadmap Preview

Future chapters will detail:

* Module responsibilities and dependencies.
* Data model and environment structures.
* Evaluator internals, including macro expansion.
* Macro system architecture (`syntax` objects, scopes, rulesets).
* Built-in library functions.
* Standard library (`stdlib.lisp`) and examples.
* Error handling, memory management, and portability.
* Testing strategy and roadmap for improvements.
